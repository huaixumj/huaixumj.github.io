(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{418:function(t,e,a){"use strict";a.r(e);var n=a(1),s=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"getlocation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getlocation"}},[t._v("#")]),t._v(" uni.getLocation(OBJECT)")]),t._v(" "),e("p",[t._v("获取当前的地理位置、速度。")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),e("p",[t._v("Web平台本API之前调用了腾讯地图的gcj02坐标免费转换接口，该接口从2024年7月18日起被腾讯逐步下线，导致老版本中本API无法使用。请立即升级到 "),e("code",[t._v("uni-app 4.24版")]),t._v("。")]),t._v(" "),e("p",[t._v("升级后注意：")]),t._v(" "),e("ol",[e("li",[t._v("cli项目需升级cli")]),t._v(" "),e("li",[t._v("App平台 manifest中配置好自己的地图厂商key，在地图厂商的后台，填写正确包名和证书摘要。地图厂商的sdk会在运行时校验key、包名、证书的一致性")]),t._v(" "),e("li",[t._v("Web平台 manifest中配置好自己的地图厂商key，使用web接口如涉及白名单，需确保自己的域名在地图厂商那里正确配置了域名白名单")]),t._v(" "),e("li",[t._v("确保在地图厂商那里配额足够")]),t._v(" "),e("li",[t._v("确保在地图厂商那里有周边服务的权限。否则无法获取周围地址")])]),t._v(" "),e("p",[t._v("如果运行在微信浏览器中，可以使用微信的jssdk的定位能力。这个是微信向腾讯地图申请的key，开发者无需配置自己的key。")]),t._v(" "),e("p",[t._v("地图厂商的商业授权较贵，如需购买，请点击"),e("a",{attrs:{href:"https://ask.dcloud.net.cn/explore/map/",target:"_blank",rel:"noopener noreferrer"}},[t._v("获取优惠"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("h3",{attrs:{id:"getlocation-兼容性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getlocation-兼容性"}},[t._v("#")]),t._v(" getLocation 兼容性")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("HarmonyOS")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("HBuilderX 4.25")])])])]),t._v(" "),e("p",[e("strong",[t._v("地图服务商说明")])]),t._v(" "),e("p",[e("RouterLink",{attrs:{to:"/component/map.html"}},[t._v("点击查看地图服务商兼容性")])],1),t._v(" "),e("p",[e("strong",[t._v("OBJECT 参数说明")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("必填")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("平台差异说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("type")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("默认为 wgs84 返回 gps 坐标，gcj02 返回国测局坐标，可用于 "),e("code",[t._v("uni.openLocation")]),t._v(" 和 map 组件坐标，App 和 H5 需配置定位 SDK 信息才可支持 gcj02。")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("altitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Boolean")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("传入 true 会返回高度信息，由于获取高度需要较高精确度，会减慢接口返回速度")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("抖音小程序、飞书小程序、支付宝小程序不支持")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("geocode")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Boolean")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("默认false，是否解析地址信息")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("仅App平台支持（安卓需指定 type 为 gcj02 并配置三方定位SDK）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("highAccuracyExpireTime")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("高精度定位超时时间(ms)，指定时间内返回最高精度，该值3000ms以上高精度定位才有效果")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("App (3.2.11+)、H5 (3.2.11+)、微信小程序 (基础库 2.9.0+)")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("timeout")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("默认为 5，定位超时时间，单位秒")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("仅飞书小程序支持")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("cacheTimeout")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("定位缓存超时时间，单位秒；每次定位缓存当前定位数据，并记下时间戳，当下次调用在cacheTimeout之内时，返回缓存数据")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("仅飞书小程序、支付宝小程序支持")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("accuracy")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("默认为 high，指定期望精度，支持 high，best。当指定 high 时，期望精度值为100m，当指定 best 时期望精度值为20m。当定位得到的精度不符合条件时，在timeout之前会继续定位，尝试拿到符合要求的定位结果")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("仅飞书小程序支持")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("isHighAccuracy")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Boolean")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("开启高精度定位")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("App (3.4.0+)、H5 (3.4.0+)、微信小程序 (基础库 2.9.0+)、抖音小程序（2.26.0+）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("success")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("接口调用成功的回调函数，返回内容详见返回参数说明。")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("fail")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("接口调用失败的回调函数")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("complete")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("接口调用结束的回调函数（调用成功、失败都会执行）")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),e("p",[e("strong",[t._v("success 返回参数说明")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("latitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("纬度，浮点数，范围为-90~90，负数表示南纬")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("longitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("经度，浮点数，范围为-180~180，负数表示西经")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("speed")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("速度，浮点数，单位m/s")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("accuracy")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("位置的精确度")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("altitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("高度，单位 m")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("verticalAccuracy")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("垂直精度，单位 m（Android 无法获取，返回 0）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("horizontalAccuracy")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("水平精度，单位 m")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("a",{attrs:{href:"/api/location/location#address"}},[t._v("address")])]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("地址信息（仅App端支持，需配置geocode为true）")])])])]),t._v(" "),e("p",[e("strong",[t._v("address 地址信息说明")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("描述")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("country")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("国家")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“中国”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("province")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("省份名称")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“北京市”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("city")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("城市名称")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“北京市”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("district")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("区（县）名称")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“朝阳区”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("street")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("街道信息")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“酒仙桥路”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("streetNum")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("获取街道门牌号信息")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“3号”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("poiName")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("POI信息")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“电子城．国际电子总部”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("postalCode")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("邮政编码")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“100016”，如果无法获取此信息则返回undefined")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("cityCode")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("城市代码")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("如“010”，如果无法获取此信息则返回undefined")])])])]),t._v(" "),e("p",[e("strong",[t._v("示例")])]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("uni"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLocation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wgs84'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'当前位置的经度：'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("longitude"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\tconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'当前位置的纬度：'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("latitude"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("strong",[t._v("注意事项")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("H5 平台")]),t._v(" "),e("ul",[e("li",[t._v("在较新的浏览器上，H5 端获取定位信息，要求部署在 "),e("strong",[t._v("https")]),t._v(" 服务上，本地预览（localhost）仍然可以使用 http 协议。")]),t._v(" "),e("li",[t._v("国产安卓手机上，H5若无法定位，检查手机是否开通位置服务、GPS，ROM是否给该浏览器位置权限、浏览器是否对网页弹出请求给予定位的询问框。")]),t._v(" "),e("li",[e("code",[t._v("安卓手机")]),t._v(" 在原生App内嵌H5时，无法定位需要原生App处理Webview。")]),t._v(" "),e("li",[e("code",[t._v("移动端浏览器")]),t._v(" 普遍仅支持GPS定位，在GPS信号弱的地方可能定位失败。")]),t._v(" "),e("li",[e("code",[t._v("PC 设备")]),t._v(" 使用 Chrome 浏览器的时候，位置信息是连接谷歌服务器获取的，国内用户可能获取位置信息失败，推荐使用Edge进行获取位置信息")]),t._v(" "),e("li",[t._v("微信公众号可使用微信js sdk，"),e("a",{attrs:{href:"https://ask.dcloud.net.cn/article/35380",target:"_blank",rel:"noopener noreferrer"}},[t._v("详见"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("code",[t._v("2.9.9 版本以上")]),t._v("，优化 uni.getLocation 支持通过 IP 定位。默认通过 GPS 获取，如果获取失败，备选方案是通过 IP 定位获取，需填写三方地图服务平台的秘钥（key）。key配置：manifest.json ---\x3e H5配置 ---\x3e 定位和地图 ---\x3e key。")])])]),t._v(" "),e("li",[e("code",[t._v("App 平台")]),t._v(" "),e("ul",[e("li",[t._v("Android由于谷歌服务被墙，或者手机上没有GMS，想正常定位就需要向高德等三方服务商申请SDK资质，获取AppKey。否则打包后定位就会不准。云打包时需要在manifest的SDK配置中填写 Appkey。在 manifest 可视化界面有详细申请指南，详见："),e("a",{attrs:{href:"https://ask.dcloud.net.cn/article/29",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ask.dcloud.net.cn/article/29"),e("OutboundLink")],1),t._v("。离线打包自行在原生工程中配置。注意"),e("strong",[t._v("包名、appkey、证书信息")]),t._v("必须匹配。真机运行可以正常定位，是因为真机运行基座使用了DCloud向高德申请的sdk配置，打包后必须由开发者自己申请。如果手机自带GMS且网络环境可以正常访问google定位服务器，此时无需在 manifest 填写高德定位的 sdk 配置。")]),t._v(" "),e("li",[t._v("注意手机自身要开启定位、同时要给App赋予定位权限。权限判断可参考："),e("a",{attrs:{href:"https://uniapp.dcloud.net.cn/api/system/getappauthorizesetting.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://uniapp.dcloud.net.cn/api/system/getappauthorizesetting.html"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("code",[t._v("<map>")]),t._v(" 组件默认为国测局坐标 gcj02，调用 "),e("code",[t._v("uni.getLocation")]),t._v(" 返回结果传递给 "),e("code",[t._v("<map>")]),t._v(" 组件时，需指定 type 为 gcj02。")]),t._v(" "),e("li",[t._v("定位 和 map 是两个东西。通过 "),e("code",[t._v("getLocation")]),t._v(" 得到位置坐标后，可以在任意map地图上展示，比如定位使用高德，地图使用 google 的 webview 版地图。如果坐标系不同时，注意转换坐标系。")]),t._v(" "),e("li",[t._v("如果使用 "),e("code",[t._v("web-view")]),t._v(" 加载地图，无需在manifest里配地图的sdk配置。")]),t._v(" "),e("li",[t._v("持续定位方案：iOS端可以申请持续定位权限，"),e("a",{attrs:{href:"https://ask.dcloud.net.cn/article/12569",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),e("OutboundLink")],1),t._v("。Android如果进程被杀，代码无法执行，可以在插件市场搜索"),e("a",{attrs:{href:"https://ext.dcloud.net.cn/search?q=%E4%BF%9D%E6%B4%BB&cat1=5",target:"_blank",rel:"noopener noreferrer"}},[t._v("保活"),e("OutboundLink")],1),t._v("相关原生语言插件避免App被系统杀死。即使使用了原生语言插件保活，也很容易被杀，此时可以使用"),e("a",{attrs:{href:"https://uniapp.dcloud.net.cn/unipush-v2.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("unipush"),e("OutboundLink")],1),t._v(" ，通过推送消息提示用户激活App")]),t._v(" "),e("li",[e("code",[t._v("3.3.0 版本以上")]),t._v(" 优化系统定位模块，可不使用三方定位SDK的进行高精度定位，具体参考："),e("a",{attrs:{href:"/app/geolocation"}},[t._v("系统定位")]),t._v("。")]),t._v(" "),e("li",[t._v("鸿蒙系统 不支持系统定位，需要配置三方sdk，比如高德，同时设置坐标系参数为 "),e("code",[t._v("type: 'gcj02'")])]),t._v(" "),e("li",[t._v("Android/iOS平台使用腾讯定位SDK需到 "),e("a",{attrs:{href:"https://lbs.qq.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("腾讯位置服务"),e("OutboundLink")],1),t._v(" 官网申请应用Key并配置：\n"),e("ul",[e("li",[e("code",[t._v("4.31 版本及以上")]),t._v(" HBuilderX内置支持腾讯定位，在manifest.json勾选配置，详情参考"),e("a",{attrs:{href:"https://uniapp.dcloud.net.cn/tutorial/app-geolocation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Geolocation定位"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("code",[t._v("4.31 版本之前")]),t._v(" 可下载"),e("a",{attrs:{href:"https://ext.dcloud.net.cn/plugin?id=14569",target:"_blank",rel:"noopener noreferrer"}},[t._v("腾讯定位插件"),e("OutboundLink")],1),t._v("，在插件中配置key打包后生效，腾讯定位是"),e("RouterLink",{attrs:{to:"/api/extapi.html"}},[t._v("ext api插件")]),t._v("引用到工程后，会覆盖uni.getLocation的实现，替换掉系统定位。")],1)])])])]),t._v(" "),e("li",[e("code",[t._v("小程序平台")]),t._v(" "),e("ul",[e("li",[t._v("api默认不返回详细地址中文描述。需要中文地址有2种方式：1、使用高德地图小程序sdk，在app和微信上都可以获得中文地址，"),e("a",{attrs:{href:"http://ask.dcloud.net.cn/article/35070",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),e("OutboundLink")],1),t._v("。2、只考虑app，使用"),e("code",[t._v("plus.geolocation")]),t._v("也可以获取中文地址。manifest里的App SDK配置仅用于app，小程序无需在这里配置。")]),t._v(" "),e("li",[t._v("可以通过用户授权API来判断用户是否给应用授予定位权限，"),e("a",{attrs:{href:"https://uniapp.dcloud.io/api/other/authorize",target:"_blank",rel:"noopener noreferrer"}},[t._v("详见"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("在 "),e("code",[t._v("微信小程序")]),t._v(" 中，当用户离开应用后，此接口无法调用，需要申请 "),e("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("后台持续定位权限"),e("OutboundLink")],1),t._v(" ，另外新版本中需要使用 "),e("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.onLocationChange.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("wx.onLocationChange"),e("OutboundLink")],1),t._v(" 监听位置信息变化；当用户点击“显示在聊天顶部”时，此接口可继续调用。")])])]),t._v(" "),e("li",[e("code",[t._v("HarmonyOS Next平台")]),t._v("调用此 API 需要申请定位权限"),e("code",[t._v("ohos.permission.APPROXIMATELY_LOCATION")]),t._v("、"),e("code",[t._v("ohos.permission.LOCATION")]),t._v("，需自行在项目中配置权限。具体位置在 "),e("code",[t._v("harmony-configs/entry/src/main/module.json5")]),t._v(" 中的 requestPermissions 字段。该配置文件在构建产物中原始鸿蒙工程相同目录内。")]),t._v(" "),e("li",[t._v("如果在app模块中勾选了系统定位和其他定位，比如腾讯定位，由配置的type值决定调用规则，type值为wgs84使用系统定位，type值为gcj02则使用腾讯定位。")])]),t._v(" "),e("h2",{attrs:{id:"chooselocation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#chooselocation"}},[t._v("#")]),t._v(" uni.chooseLocation(OBJECT)")]),t._v(" "),e("p",[t._v("打开地图选择位置。chooseLocation会使用项目配置的地图服务商来展示地图，地图服务商支持情况参考："),e("RouterLink",{attrs:{to:"/component/map.html"}},[t._v("map组件")]),t._v("。")],1),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),e("p",[t._v("Web平台和App平台，本API之前调用了腾讯地图的gcj02坐标免费，该接口从2024年7月18日起被腾讯逐步下线，导致老版本中本API无法使用。请立即升级到 "),e("code",[t._v("uni-app 4.24版")]),t._v("。")]),t._v(" "),e("p",[t._v("升级后注意：")]),t._v(" "),e("ol",[e("li",[t._v("如果是cli或离线打包，需要配套升级cli和离线sdk")]),t._v(" "),e("li",[t._v("manifest中配置好自己的地图厂商key。web和app都需要。一般标准基座正常，自定义基座和打包后异常，都是这个原因")]),t._v(" "),e("li",[t._v("确保在地图厂商那里配额足够")]),t._v(" "),e("li",[t._v("确保在地图厂商那里有周边服务的权限。否则无法获取周围地址")]),t._v(" "),e("li",[t._v("web平台确保自己的域名在地图厂商那里正确配置了域名白名单")])]),t._v(" "),e("p",[t._v("地图厂商的商业授权较贵，如需购买，请点击"),e("a",{attrs:{href:"https://ask.dcloud.net.cn/explore/map/",target:"_blank",rel:"noopener noreferrer"}},[t._v("获取优惠"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),e("p",[e("strong",[t._v("平台差异说明")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("App")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("H5")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("微信小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("支付宝小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("百度小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("抖音小程序、飞书小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("QQ小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("快手小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("京东小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("元服务")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("x")])])])]),t._v(" "),e("h3",{attrs:{id:"chooselocation-兼容性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#chooselocation-兼容性"}},[t._v("#")]),t._v(" chooseLocation 兼容性")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("HarmonyOS")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("HBuilderX 4.23")])])])]),t._v(" "),e("p",[e("strong",[t._v("地图服务商说明")])]),t._v(" "),e("p",[e("RouterLink",{attrs:{to:"/component/map.html"}},[t._v("点击查看地图服务商兼容性")])],1),t._v(" "),e("p",[e("strong",[t._v("OBJECT 参数说明")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("参数名")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("必填")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("平台差异说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("latitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("目标地纬度")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("微信小程序（2.9.0+）、H5-Vue3（3.2.10+）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("longitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("目标地经度")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("微信小程序（2.9.0+）、H5-Vue3（3.2.10+）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("keyword")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("搜索关键字，仅App平台支持")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("useSecureNetwork")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Boolea")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是否通过安全网络调用地点搜索、逆地址解析，默认false")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("success")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("接口调用成功的回调函数，返回内容详见返回参数说明。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("fail")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("接口调用失败的回调函数（获取定位失败、用户取消等情况下触发）")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("complete")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Function")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("接口调用结束的回调函数（调用成功、失败都会执行）")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}})])])]),t._v(" "),e("p",[e("strong",[t._v("腾讯地图服务商说明")])]),t._v(" "),e("p",[t._v("出于安全考虑，安卓、iOS端manifest.json内配置的key仅用来展示地图，uni.chooseLocation所依赖的地点搜索、逆地址解析功能需要通过uniCloud云对象"),e("a",{attrs:{href:"https://ext.dcloud.net.cn/plugin?id=13872",target:"_blank",rel:"noopener noreferrer"}},[t._v("uni-map-co"),e("OutboundLink")],1),t._v("来调用，开发者可以通过安全网络来保障服务端api不被他人盗用。")]),t._v(" "),e("p",[t._v("鸿蒙平台由于暂不支持安全网络，所以chooseLocation依然使用manifest.json内配置的key来调用地点搜索、逆地址解析。")]),t._v(" "),e("p",[t._v("默认情况下，uni.chooseLocation不会使用安全网络请求uni-map-co。如果需要使用安全网络请求uni-map-co，需按如下步骤操作：")]),t._v(" "),e("ol",[e("li",[t._v("项目关联uniCloud服务空间")]),t._v(" "),e("li",[t._v("参考"),e("a",{attrs:{href:"https://ext.dcloud.net.cn/plugin?id=13872",target:"_blank",rel:"noopener noreferrer"}},[t._v("uni-map-co"),e("OutboundLink")],1),t._v("文档导入uni-map-common插件，并配置好地图的key。")]),t._v(" "),e("li",[t._v("参考"),e("a",{attrs:{href:"https://doc.dcloud.net.cn/uniCloud/secure-network.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("安全网络"),e("OutboundLink")],1),t._v("文档，将应用关联到服务空间。")]),t._v(" "),e("li",[t._v("在项目manifest.json中"),e("code",[t._v("安卓/iOS模块配置")]),t._v("中勾选安全网络模块。")]),t._v(" "),e("li",[t._v("修改uni-map-co入口文件"),e("code",[t._v("index.obj.js")]),t._v("内添加如下代码，拦截非法请求：")])]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("_before")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" clientInfo "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getClientInfo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" methodName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMethodName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" secretType "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clientInfo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("secretType\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("methodName "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'chooseLocation'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" secretType "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'both'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" secretType "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'request'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Error")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Unauthorized client'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("ol",{attrs:{start:"6"}},[e("li",[t._v("上传uni-map-co云对象、uni-config-center公共模块、uni-map-common公共模块。")]),t._v(" "),e("li",[t._v("调用uni.chooseLocation时，将useSecureNetwork设置为true。")])]),t._v(" "),e("p",[e("strong",[t._v("注意")])]),t._v(" "),e("ul",[e("li",[t._v("因平台差异，如果SDK配置百度地图，需要设置 keyword，才能显示相关地点")]),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/collocation/manifest.html#app-plus"}},[t._v("非 weex 编译模式")]),t._v("不支持百度地图")],1)]),t._v(" "),e("p",[e("strong",[t._v("success 返回参数说明")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("name")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("位置名称")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("address")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("详细地址")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("latitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("纬度，浮点数，范围为-90~90，负数表示南纬，使用 gcj02 国测局坐标系。")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("longitude")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("经度，浮点数，范围为-180~180，负数表示西经，使用 gcj02 国测局坐标系。")])])])]),t._v(" "),e("p",[e("strong",[t._v("示例")])]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[t._v("uni"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("chooseLocation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'位置名称：'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\tconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'详细地址：'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\tconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'纬度：'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("latitude"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\tconsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'经度：'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("longitude"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("strong",[t._v("注意")])]),t._v(" "),e("ul",[e("li",[t._v("不同端，使用地图选择时基于的底层地图引擎不一样，详见地图"),e("a",{attrs:{href:"/component/map"}},[t._v("map")]),t._v("组件的地图服务商支持。\n"),e("ul",[e("li",[e("code",[t._v("app")]),t._v(" 中也可以使用百度定位，在 manifest 中配置，打包后生效。")]),t._v(" "),e("li",[e("code",[t._v("app-nvue")]),t._v(" 里只能用高德定位和Google地图(3.4+)，不能用百度地图。另外选择地图、查看地图位置的API也仅支持高德地图和Google地图(3.4+)。所以App端如无特殊必要，建议使用高德地图。")])])]),t._v(" "),e("li",[e("code",[t._v("H5 端")]),t._v(" 使用地图和定位相关，需要在 "),e("a",{attrs:{href:"/collocation/manifest#h5sdkconfig"}},[t._v("manifest.json")]),t._v(" 内配置腾讯或谷歌等三方地图服务商申请的秘钥（key）。")]),t._v(" "),e("li",[e("code",[t._v("微信内置浏览器")]),t._v(" 中可使用微信js sdk，"),e("a",{attrs:{href:"https://ask.dcloud.net.cn/article/35380",target:"_blank",rel:"noopener noreferrer"}},[t._v("详见"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("chooseLocation 属于封装型API，开发者若觉得不够灵活，可自行基于原始的 map 组件进行封装。插件市场已经有各种封装样例了。")]),t._v(" "),e("li",[t._v("若 "),e("code",[t._v("Android App端")]),t._v(" 位置不准，见上文 uni.getLocation 的注意事项")]),t._v(" "),e("li",[t._v("微信小程序在2023年10月17日之后，使用API需要配置"),e("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/user-privacy/PrivacyAuthorize.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("隐私协议"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"三方定位和地图服务收费说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三方定位和地图服务收费说明"}},[t._v("#")]),t._v(" 三方定位和地图服务收费说明")]),t._v(" "),e("p",[t._v("使用三方定位或者地图服务，需向服务提供商（如：高德地图、百度地图、腾讯地图、谷歌地图）申请商业授权和缴纳费用（5万/年）。")]),t._v(" "),e("p",[t._v("DCloud为开发者争取了福利，可优惠获取高德、腾讯的商业授权。如有需求请发邮件到"),e("code",[t._v("bd@dcloud.io")]),t._v("（注明你的公司名称、应用介绍、HBuilder账户）；你也可以直接通过"),e("code",[t._v("uni-im")]),t._v("发起在线咨询，在线咨询地址："),e("a",{attrs:{href:"https://im.dcloud.net.cn/#/?user_id=b9839630-a479-11ea-b772-0f6ad6cf835c",target:"_blank",rel:"noopener noreferrer"}},[t._v("DCloud地图服务专员"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[t._v("详见："),e("a",{attrs:{href:"https://uniapp.dcloud.net.cn/tutorial/app-geolocation.html#lic",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://uniapp.dcloud.net.cn/tutorial/app-geolocation.html#lic"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"unicloud-city-select-城市选择组件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#unicloud-city-select-城市选择组件"}},[t._v("#")]),t._v(" unicloud-city-select 城市选择组件")]),t._v(" "),e("p",[t._v("若想要实现城市选择功能，可以使用 "),e("code",[t._v("unicloud-city-select")]),t._v(" 城市选择组件。")]),t._v(" "),e("p",[e("strong",[t._v("运行效果图")])]),t._v(" "),e("p",[e("img",{attrs:{src:"/images/410.png",alt:""}})]),t._v(" "),e("blockquote",[e("p",[t._v("下载地址："),e("a",{attrs:{href:"https://ext.dcloud.net.cn/plugin?name=unicloud-city-select",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ext.dcloud.net.cn/plugin?name=unicloud-city-select"),e("OutboundLink")],1)])]),t._v(" "),e("blockquote",[e("p",[t._v("文档地址："),e("a",{attrs:{href:"https://doc.dcloud.net.cn/uniCloud/unicloud-city-select.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://doc.dcloud.net.cn/uniCloud/unicloud-city-select.html"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"【福利】高德拉新活动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#【福利】高德拉新活动"}},[t._v("#")]),t._v(" 【福利】高德拉新活动")]),t._v(" "),e("p",[t._v("一键注册高德企业开发者，最高可获取210元奖励金，详见"),e("a",{attrs:{href:"https://ask.dcloud.net.cn/article/41279",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://ask.dcloud.net.cn/article/41279"),e("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=s.exports}}]);