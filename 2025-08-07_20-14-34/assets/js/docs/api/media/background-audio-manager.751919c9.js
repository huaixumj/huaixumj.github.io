(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{422:function(t,e,a){"use strict";a.r(e);var l=a(1),i=Object(l.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"getbackgroundaudiomanager"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getbackgroundaudiomanager"}},[t._v("#")]),t._v(" uni.getBackgroundAudioManager()")]),t._v(" "),e("p",[t._v("获取"),e("strong",[t._v("全局唯一")]),t._v("的背景音频管理器 "),e("code",[t._v("backgroundAudioManager")]),t._v("。")]),t._v(" "),e("p",[t._v("背景音频，不是游戏的背景音乐，而是类似QQ音乐那样，App在后台时，仍然在播放音乐。如果你不需要在App切后台时继续播放，那么不应该使用本API，而应该使用普通音频API"),e("a",{attrs:{href:"https://uniapp.dcloud.io/api/media/audio-context",target:"_blank",rel:"noopener noreferrer"}},[t._v("uni.createInnerAudioContext"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("p",[e("strong",[t._v("平台差异说明")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("App")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("H5")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("微信小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("支付宝小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("百度小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("抖音小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("飞书小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("QQ小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("快手小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("京东小程序")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("元服务")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("小红书小程序")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("1.11.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("5.20.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("x")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("x")])])])]),t._v(" "),e("h3",{attrs:{id:"getbackgroundaudiomanager-兼容性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getbackgroundaudiomanager-兼容性"}},[t._v("#")]),t._v(" getBackgroundAudioManager 兼容性")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("HarmonyOS")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("HBuilderX 4.31")])])])]),t._v(" "),e("p",[e("strong",[t._v("backgroundAudioManager 对象的属性列表")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("只读")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("duration")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("当前音频的长度（单位：s），只有在当前有合法的 src 时返回")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("currentTime")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("当前音频的播放位置（单位：s），只有在当前有合法的 src 时返回")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("paused")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Boolean")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("当前是是否暂停或停止状态，true 表示暂停或停止，false 表示正在播放")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("src")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("音频的数据源，默认为空字符串，**当设置了新的 src 时，会自动开始播放，**目前支持的格式有 m4a, aac, mp3, wav")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("startTime")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("音频开始播放的位置（单位：s）")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("buffered")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("音频缓冲的时间点，仅保证当前播放时间点到此时间点内容已缓冲。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("是")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("title")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("音频标题，用于做原生音频播放器音频标题。原生音频播放器中的分享功能，分享出去的卡片标题，也将使用该值。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("epname")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("专辑名，原生音频播放器中的分享功能，分享出去的卡片简介，也将使用该值。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("singer")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("歌手名，原生音频播放器中的分享功能，分享出去的卡片简介，也将使用该值。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("coverImgUrl")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("封面图url，用于做原生音频播放器背景图。原生音频播放器中的分享功能，分享出去的卡片配图及背景也将使用该图。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("webUrl")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("页面链接，原生音频播放器中的分享功能，分享出去的卡片简介，也将使用该值。")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("protocol")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("String")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("音频协议。默认值为 'http'，设置 'hls' 可以支持播放 HLS 协议的直播音频，App平台暂不支持")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("playbackRate")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("播放的倍率。可取值：0.5/0.8/1.0/1.25/1.5/2.0，默认值为1.0。(App 3.4.5+、微信基础库 2.11.0+、支付宝小程序、抖音小程序 2.33.0+、快手小程序、百度小程序 3.120.2+)")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("否")])])])]),t._v(" "),e("p",[e("strong",[t._v("backgroundAudioManager 对象的方法列表")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("方法")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("参数")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("play")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("播放")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("pause")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("暂停")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("stop")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("停止")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("seek")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("position")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("跳转到指定位置，单位 s")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onCanplay")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("背景音频进入可以播放状态，但不保证后面可以流畅播放")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onPlay")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("背景音频播放事件")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onPause")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("背景音频暂停事件")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onStop")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("背景音频停止事件")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onEnded")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("背景音频自然播放结束事件")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onTimeUpdate")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("背景音频播放进度更新事件")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onPrev")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("用户在系统音乐播放面板点击上一曲事件（iOS only）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onNext")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("用户在系统音乐播放面板点击下一曲事件（iOS only）")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onError")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("背景音频播放错误事件")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("onWaiting")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("callback")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("音频加载中事件，当音频因为数据不足，需要停下来加载时会触发")])])])]),t._v(" "),e("p",[t._v("errCode 说明")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("errCode")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("10001")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("系统错误")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("10002")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("网络错误")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("10003")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("文件错误")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("10004")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("格式错误")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("-1")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("未知错误")])])])]),t._v(" "),e("p",[e("strong",[t._v("示例")])]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bgAudioManager "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" uni"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBackgroundAudioManager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbgAudioManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'致爱丽丝'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbgAudioManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("singer "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'暂无'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbgAudioManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("coverImgUrl "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/music-a.png'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbgAudioManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://web-ext-storage.dcloud.net.cn/uni-app/ForElise.mp3'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("strong",[t._v("注意")]),t._v("\n因为背景音频播放耗费手机电量，所以平台都有管控，需在manifest中填写申请。")]),t._v(" "),e("ul",[e("li",[t._v("ios App平台，背景播放需在manifest.json -> app-plus -> distribute -> ios 节点添加 "),e("code",[t._v('"UIBackgroundModes":["audio"]')]),t._v(" 才能保证音乐可以后台播放（打包成ipa生效）")]),t._v(" "),e("li",[t._v('小程序平台，需在manifest.json 对应的小程序节点下，填写"requiredBackgroundModes": ["audio"]。发布小程序时平台会审核')]),t._v(" "),e("li",[t._v("Android App端默认不会在通知栏出现音量控制，如需此功能，需要在插件市场单独下载原生插件，"),e("a",{attrs:{href:"https://ext.dcloud.net.cn/search?q=%E9%80%9A%E7%9F%A5%E6%A0%8F+%E9%9F%B3%E4%B9%90%E6%8E%A7%E5%88%B6",target:"_blank",rel:"noopener noreferrer"}},[t._v("详见"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("鸿蒙元服务支持 "),e("code",[t._v("uni.playBackgroundAudio")]),t._v(" 相关 api，"),e("a",{attrs:{href:"https://developer.huawei.com/consumer/cn/doc/atomic-ascf/apis-background-audio?ha_source=Dcloud&ha_sourceId=89000448",target:"_blank",rel:"noopener noreferrer"}},[t._v("详见"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=i.exports}}]);