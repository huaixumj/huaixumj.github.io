(window.webpackJsonp=window.webpackJsonp||[]).push([[511],{892:function(e,t,s){"use strict";s.r(t);var r=s(1),n=Object(r.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("blockquote",[t("p",[e._v("HBuilderX 2.7.10+ 版本以上支持FCM")])]),e._v(" "),t("h2",{attrs:{id:"概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[e._v("#")]),e._v(" 概述")]),e._v(" "),t("p",[e._v("在海外网络环境下，部分网络在连接"),t("code",[e._v("uni-push")]),e._v("技术支持供应商个推的推送服务时，可能出现不稳定的情况。此时，开发者可以接入 FCM 辅助通道，当在个推服务断线的情况下，通过谷歌的 FCM 推送通道下发消息，提升推送到达率。")]),e._v(" "),t("p",[t("strong",[e._v("使用FCM时手机端需安装Google移动服务（GMS），并且可以正常连接Google服务（国内网络需要翻墙）")])]),e._v(" "),t("p",[e._v("使用FCM必须先开通使用"),t("code",[e._v("uni-push")]),e._v("：")]),e._v(" "),t("ul",[t("li",[e._v("开通"),t("code",[e._v("uni-push")]),e._v("服务参考："),t("RouterLink",{attrs:{to:"/uni-push/open.html"}},[e._v("如何开通uni-push")])],1),e._v(" "),t("li",[e._v("App端使用"),t("code",[e._v("uni-push")]),e._v("参考：\n"),t("ul",[t("li",[t("RouterLink",{attrs:{to:"/unipush-v2.html"}},[e._v("uni-push 2.0")])],1),e._v(" "),t("li",[t("RouterLink",{attrs:{to:"/unipush-v1.html"}},[e._v("uni-push 1.0")])],1)])])]),e._v(" "),t("h2",{attrs:{id:"从谷歌后台申请key信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从谷歌后台申请key信息"}},[e._v("#")]),e._v(" 从谷歌后台申请key信息")]),e._v(" "),t("p",[e._v("进入 "),t("a",{attrs:{href:"https://firebase.google.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Firebase官网"),t("OutboundLink")],1),e._v("创建项目，获取"),t("code",[e._v("google-services.json")]),e._v("文件及"),t("code",[e._v("Server key")]),e._v("。")]),e._v(" "),t("p",[e._v("登录google账号，如果没有账号请先注册\n"),t("img",{attrs:{src:"/images/signin.png",alt:""}})]),e._v(" "),t("p",[e._v("登录后点击右上角的“Go to console”\n"),t("img",{attrs:{src:"/images/gotoconsole.png",alt:""}})]),e._v(" "),t("p",[e._v("打开项目列表页面，点击“Add project”创建项目\n"),t("img",{attrs:{src:"/images/addproject.png",alt:""}})]),e._v(" "),t("p",[e._v("输入项目名称（根据自己应用取名），点击“Continue”\n"),t("img",{attrs:{src:"/images/createproject1.png",alt:""}})]),e._v(" "),t("p",[e._v("确认是否需要使用Google Analytics服务（根据自己需要开启或关闭），点击“Continue”\n"),t("img",{attrs:{src:"/images/createproject2.png",alt:""}})]),e._v(" "),t("p",[e._v("确认后创建项目，点击“Continue”\n"),t("img",{attrs:{src:"/images/createproject3.png",alt:""}})]),e._v(" "),t("p",[e._v("进入项目详情页面，点击“Android”图标添加Android应用\n"),t("img",{attrs:{src:"/images/android.png",alt:""}})]),e._v(" "),t("p",[e._v("输入Android应用信息（包名、昵称、证书SHA-1），点击“Register App”\n"),t("img",{attrs:{src:"/images/regapp.png",alt:""}})]),e._v(" "),t("p",[e._v("注册Android应用后下载配置文件“google-services.json”，"),t("strong",[e._v("保存google-services.json文件后面需要使用")]),e._v("\n点击“Next”继续\n"),t("img",{attrs:{src:"/images/download.png",alt:""}})]),e._v(" "),t("p",[e._v("此步骤中的操作云端打包机已经处理，忽略提示信息，继续点击“Next”，进入下一步\n完成注册Android应用，点击“Continue to console”回到项目详情页面\n"),t("img",{attrs:{src:"/images/continuetoconsole.png",alt:""}})]),e._v(" "),t("p",[e._v("点击“Project settings”，进入项目设置页面\n"),t("img",{attrs:{src:"/images/settings.png",alt:""}})]),e._v(" "),t("p",[e._v("切换到“Cloud Messaging”项，获取“Server key”，"),t("strong",[e._v("保存Server key后面需要使用")])]),e._v(" "),t("p",[e._v("由于新版"),t("code",[e._v("Firebase Cloud Messaging API (V1)")]),e._v("不提供"),t("code",[e._v("Server key")]),e._v(", 所以需要手动开启旧版 "),t("code",[e._v("Cloud Messaging API")]),e._v(" 。\n"),t("img",{attrs:{src:"/images/firebase_android_setup_get_server_key.png",alt:""}})]),e._v(" "),t("p",[e._v("跳转到Api管理页面启动"),t("code",[e._v("Cloud Messaging API")])]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/firebase_android_open_old_api.png",alt:""}})]),e._v(" "),t("p",[e._v("启动"),t("code",[e._v("Cloud Messaging API")]),e._v("后即可得到"),t("code",[e._v("Server key")])]),e._v(" "),t("p",[t("img",{attrs:{src:"/images/firebase_android_server_key.png",alt:""}})]),e._v(" "),t("h2",{attrs:{id:"uni-push后台配置fcm参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#uni-push后台配置fcm参数"}},[e._v("#")]),e._v(" "),t("code",[e._v("uni-push")]),e._v("后台配置FCM参数")]),e._v(" "),t("p",[e._v("参考文档 "),t("RouterLink",{attrs:{to:"/uni-push/open.html#other-config"}},[e._v("配置厂商推送参数")]),e._v(" 完成FCM参数配置。")],1),e._v(" "),t("p",[e._v("配置保存成功后在HBuilderX中重新提交云端打包，并在“App-云打包”界面选择"),t("code",[e._v("google play")]),e._v("渠道：\n"),t("img",{attrs:{src:"/images/hx_package.png",alt:""}})]),e._v(" "),t("p",[e._v("如果你已经完成了"),t("code",[e._v("uni-push")]),e._v("的代码开发，只需完成上述配置和打包即可，不用修改代码。")]),e._v(" "),t("h2",{attrs:{id:"本地离线打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本地离线打包"}},[e._v("#")]),e._v(" 本地离线打包")]),e._v(" "),t("p",[e._v("Android平台离线sdk集成"),t("code",[e._v("uni-push")]),e._v("支持FCM可参考："),t("a",{attrs:{href:"https://nativesupport.dcloud.net.cn/AppDocs/usemodule/androidModuleConfig/push?id=%e8%b0%b7%e6%ad%8c%e6%8e%a8%e9%80%81",target:"_blank",rel:"noopener noreferrer"}},[e._v("Push(消息推送)"),t("OutboundLink")],1)]),e._v(" "),t("h2",{attrs:{id:"注意事项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[e._v("#")]),e._v(" 注意事项")]),e._v(" "),t("p",[t("strong",[e._v("FCM 离线消息仅支持GOOGLE 推送，暂不支持国内设备商的海外发行版本")])])])}),[],!1,null,null,null);t.default=n.exports}}]);